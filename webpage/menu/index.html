<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>메뉴 페이지</title>
    <link rel="stylesheet" type="text/css" href="../styles.css" />
    <link rel="stylesheet" type="text/css" href="menu.css" />
    <style>
      #user-info {
        position: absolute;
        top: 10px;
        right: 10px;
        text-align: right;
      }
      #user-info span {
        display: block;
      }
    </style>
  </head>
  <body>
    <div id="user-info">
      <span id="user-email"></span>
      <span id="user-name"></span>
      <button onclick="logout()">로그아웃</button>
    </div>
    <div id="container">
      <div id="menu-message">Please select menu</div>
      <button class="menu-button" onclick="redirectToProcedure()">
        점검절차 생성
      </button>
      <button class="menu-button" onclick="redirectToReport()">
        보고서 확인
      </button>
      <button class="menu-button" onclick="redirectToConference()">
        화상회의
      </button>
    </div>

    <script>
      function redirectToProcedure() {
        window.location.href = "/report";
      }

      function redirectToReport() {
        window.location.href = "/infra";
      }

      function redirectToConference() {
        window.location.href = "/webmeeting";
      }

      // 쿠키 값을 읽는 함수
      function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(";").shift();
      }

      // 페이지 로드 시 이메일과 이름을 표시
      document.addEventListener("DOMContentLoaded", () => {
        const company = getCookie("company");
        const number = getCookie("employee_number");

        if (company) {
          document.getElementById(
            "user-email"
          ).textContent = `회사: ${company}`;
        } else {
          console.log("쿠키가 없네요");
          window.location.href = "/login";
        }

        if (number) {
          document.getElementById(
            "user-name"
          ).textContent = `회사 번호: ${number}`;
        } else {
          window.location.href = "/login";
        }
      });
    </script>

    <script>
      function deleteAllCookies() {
        const cookies = document.cookie.split(";");
        for (let i = 0; i < cookies.length; i++) {
          const cookie = cookies[i];
          const eqPos = cookie.indexOf("=");
          const name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
          document.cookie =
            name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
        }
      }

      function logout() {
        deleteAllCookies();
        window.location.href = "https://accounts.google.com/Logout";
      }
    </script>
  </body>
</html>
